# 色々考えていること

## 手軽な遷移

ある状態からある状態へ手軽に遷移できて欲しい。

### 配信形態の手軽な遷移

状態を配信形態として扱った場合のこと。

最も手軽な配信形態はCLIのコマンドとして。これは個人に対する配信。

他の開発者にアクセスを許可するとしたらwebAPIでの配信ということになるかもしれない。例えばこの遷移を手軽に行いたい。

もう少しアクセスが制限されたユーザーへ配信ということになる場合にはslackやdiscordのbotとしての配信ということも考えられる。極端な話これらをtokenを設定するだけの手間で対応しちゃいたい。

### 実行形態の手軽な遷移

状態を実行形態として扱った場合のこと。

最も手軽な実行形態は同期的実行。複数のタスクが並行的に行われることがない、実行に要する時間が短い場合などにはこの形態で十分。最も素直な実行形態。

処理が重たい場合には外部的なキューを作って実行したくなるかもしれない。つまりコマンドとしてはkickだけで終わるようなもの。例えばwebAPIなど経由で実行したりbot経由で実行がenqueueされた場合などにはタスクキューを間に挟んでの実行が行われて欲しい。

タスクキューの実装にも手元のインメモリーな実装で済ませてしまうもの、redis的なミドルウェアを経由して実装するもの、AWSやGCPなどのクラウドサービスのpub/subをベースにして実装するものという段階が色々ありそう。

例えばAWSのSQSをベースに実行されるような形になった場合には、設定の作成と疎通確認が手軽にできてほしい。内部的にworker(consumer)を実行するような1processで済むような形で実行するとしても、wokerとしてだけ実行できるというような事は手軽にできて欲しい(main processからsub processをspawnではなく直接実行)。

### 出力形態の手軽な遷移

出力自体も標準出力に吐き出す方針、全ての出力結果を記録して最後にresponseに含めるような方針、あるいはwebsocket的なchannelを開いてそこに送信し続けるような方針など幾つかありそう。

細かい話をするとloggerのようなものの実装にも幾つか種類があるかもしれない。

## pluggableにしたいの？

pluggableにしたいかというとそれは違う。特定の形態を定めた時にその実装は１つで十分。ある状態や形態の遷移を手軽に行いたいという点が大切な気持ち。

あるチーム内で利用するというようなそこそこ利用者数の規模が小さめな内部的なサービスあたりを対象として考えている。なので手間をかけたくないという意識の方が大切。pluggableなだけではダメで使いかたがわかりやすい、メンテもしやすいというような感じになっていて欲しい。
